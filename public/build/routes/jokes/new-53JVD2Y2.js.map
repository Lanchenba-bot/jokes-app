{
  "version": 3,
  "sources": ["empty-module:~/utils/request.server", "../../../../app/routes/jokes/new.tsx"],
  "sourcesContent": ["module.exports = {};", "import type { ActionArgs } from \"@remix-run/node\"\r\nimport { redirect } from \"@remix-run/node\"\r\nimport { useActionData } from \"@remix-run/react\"\r\nimport { ensureUserPresent } from \"~/controllers/controller-hooks/ensure-user-present\"\r\n\r\nimport { db } from \"~/utils/db.server\"\r\nimport { badRequest } from \"~/utils/request.server\"\r\n\r\n\r\nfunction validateJokeContent(content: string) {\r\n  if (content.length < 10) {\r\n    return \"That joke is too short\"\r\n  }\r\n}\r\n\r\nfunction validateJokeName(name: string) {\r\n  if (name.length < 3) {\r\n    return \"That joke's name is too short\"\r\n  }\r\n}\r\n\r\nexport const action = async ({ request }: ActionArgs) => {\r\n  const { user } = await ensureUserPresent({ request })\r\n\r\n  const form = await request.formData()\r\n\r\n  const content = form.get(\"content\")\r\n  const name = form.get(\"name\")\r\n\r\n  if (typeof content !== \"string\" || typeof name !== \"string\") {\r\n    return badRequest({\r\n      fieldErrors: null,\r\n      fields: null,\r\n      formError: \"Form not submitted correctly.\",\r\n    })\r\n  }\r\n\r\n  const fieldErrors = {\r\n    content: validateJokeContent(content),\r\n    name: validateJokeName(name),\r\n  }\r\n  const fields = { content, name }\r\n  if (Object.values(fieldErrors).some(Boolean)) {\r\n    return badRequest({\r\n      fieldErrors,\r\n      fields,\r\n      formError: null,\r\n    })\r\n  }\r\n\r\n  const joke = await db.joke.create({\r\n    data: { ...fields, jokesterId: user.id },\r\n  })\r\n  return redirect(`/jokes/${joke.id}`)\r\n}\r\n\r\nexport default function NewJokeRoute() {\r\n  const actionData = useActionData<typeof action>()\r\n\r\n  return (\r\n    <div>\r\n      <p>Add your own hilarious joke</p>\r\n      <form method=\"post\">\r\n        <div>\r\n          <label>\r\n            Name:{\" \"}\r\n            <input\r\n              defaultValue={actionData?.fields?.name}\r\n              name=\"name\"\r\n              type=\"text\"\r\n              aria-invalid={Boolean(actionData?.fieldErrors?.name)}\r\n              aria-errormessage={\r\n                actionData?.fieldErrors?.name ? \"name-error\" : undefined\r\n              }\r\n            />\r\n          </label>\r\n          {actionData?.fieldErrors?.name ? (\r\n            <p className=\"form-validation-error\" id=\"name-error\" role=\"alert\">\r\n              {actionData.fieldErrors.name}\r\n            </p>\r\n          ) : null}\r\n        </div>\r\n        <div>\r\n          <label>\r\n            Content:{\" \"}\r\n            <textarea\r\n              defaultValue={actionData?.fields?.content}\r\n              name=\"content\"\r\n              aria-invalid={Boolean(actionData?.fieldErrors?.content)}\r\n              aria-errormessage={\r\n                actionData?.fieldErrors?.content ? \"content-error\" : undefined\r\n              }\r\n            />\r\n          </label>\r\n          {actionData?.fieldErrors?.content ? (\r\n            <p\r\n              className=\"form-validation-error\"\r\n              id=\"content-error\"\r\n              role=\"alert\">\r\n              {actionData.fieldErrors.content}\r\n            </p>\r\n          ) : null}\r\n        </div>\r\n        <div>\r\n          {actionData?.formError ? (\r\n            <p className=\"form-validation-error\" role=\"alert\">\r\n              {actionData.formError}\r\n            </p>\r\n          ) : null}\r\n          <button type=\"submit\" className=\"button\">\r\n            Add\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  )\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;AAAA;AAAA;AAAA,WAAO,UAAU,CAAC;AAAA;AAAA;;;ACClB,kBAAyB;AAIzB,gBAAmB;AACnB,qBAA2B;AAuDrB;AALS,SAAR,eAAgC;AAxDvC;AAyDE,QAAM,aAAa,cAA6B;AAEhD,SACE,mDAAC,SACC;AAAA,uDAAC,OAAE,2CAAH;AAAA;AAAA;AAAA;AAAA,WAA8B;AAAA,IAC9B,mDAAC,UAAK,QAAO,QACX;AAAA,yDAAC,SACC;AAAA,2DAAC,WAAM;AAAA;AAAA,UACC;AAAA,UACN;AAAA,YAAC;AAAA;AAAA,cACC,eAAc,8CAAY,WAAZ,mBAAoB;AAAA,cAClC,MAAK;AAAA,cACL,MAAK;AAAA,cACL,gBAAc,SAAQ,8CAAY,gBAAZ,mBAAyB,IAAI;AAAA,cACnD,uBACE,8CAAY,gBAAZ,mBAAyB,QAAO,eAAe;AAAA;AAAA,YANnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAQA;AAAA,aAVF;AAAA;AAAA;AAAA;AAAA,eAWA;AAAA,UACC,8CAAY,gBAAZ,mBAAyB,QACxB,mDAAC,OAAE,WAAU,yBAAwB,IAAG,cAAa,MAAK,SACvD,qBAAW,YAAY,QAD1B;AAAA;AAAA;AAAA;AAAA,eAEA,IACE;AAAA,WAjBN;AAAA;AAAA;AAAA;AAAA,aAkBA;AAAA,MACA,mDAAC,SACC;AAAA,2DAAC,WAAM;AAAA;AAAA,UACI;AAAA,UACT;AAAA,YAAC;AAAA;AAAA,cACC,eAAc,8CAAY,WAAZ,mBAAoB;AAAA,cAClC,MAAK;AAAA,cACL,gBAAc,SAAQ,8CAAY,gBAAZ,mBAAyB,OAAO;AAAA,cACtD,uBACE,8CAAY,gBAAZ,mBAAyB,WAAU,kBAAkB;AAAA;AAAA,YALzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAOA;AAAA,aATF;AAAA;AAAA;AAAA;AAAA,eAUA;AAAA,UACC,8CAAY,gBAAZ,mBAAyB,WACxB;AAAA,UAAC;AAAA;AAAA,YACC,WAAU;AAAA,YACV,IAAG;AAAA,YACH,MAAK;AAAA,YACJ,qBAAW,YAAY;AAAA;AAAA,UAJ1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAKA,IACE;AAAA,WAnBN;AAAA;AAAA;AAAA;AAAA,aAoBA;AAAA,MACA,mDAAC,SACE;AAAA,kDAAY,aACX,mDAAC,OAAE,WAAU,yBAAwB,MAAK,SACvC,qBAAW,aADd;AAAA;AAAA;AAAA;AAAA,eAEA,IACE;AAAA,QACJ,mDAAC,YAAO,MAAK,UAAS,WAAU,UAAS,mBAAzC;AAAA;AAAA;AAAA;AAAA,eAEA;AAAA,WARF;AAAA;AAAA;AAAA;AAAA,aASA;AAAA,SAlDF;AAAA;AAAA;AAAA;AAAA,WAmDA;AAAA,OArDF;AAAA;AAAA;AAAA;AAAA,SAsDA;AAEJ;",
  "names": []
}
